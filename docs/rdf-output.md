# Understanding RDF Output

Complete guide to understanding, validating, and working with the RDF triples generated by vault-triplifier.

## What is RDF?

RDF (Resource Description Framework) is a standard for representing information as interconnected statements called triples. Each triple has three parts:

- **Subject**: What the statement is about
- **Predicate**: The property or relationship type  
- **Object**: The value or target of the relationship

```turtle
<alice> <knows> <bob> .
# Subject: alice
# Predicate: knows  
# Object: bob
```

## Basic RDF Generation

### Simple Properties
From this markdown:
```markdown
# Alice
name :: Alice Wonderland
age :: 25
email :: alice@example.com
```

Vault-triplifier generates:
```turtle
<file:///Alice> <http://example.org/name> "Alice Wonderland" ;
    <http://example.org/age> "25" ;
    <http://example.org/email> "alice@example.com" .
```

### With Namespaces
From this markdown:
```markdown
# Alice  
schema:name :: Alice Wonderland
schema:age :: 25
foaf:knows :: [[Bob]]
```

Generates:
```turtle
<file:///Alice> <http://schema.org/name> "Alice Wonderland" ;
    <http://schema.org/age> "25" ;
    <http://xmlns.com/foaf/0.1/knows> <file:///Bob> .
```

## Subject Generation

### Document Subjects
```markdown
# Alice.md
name :: Alice
```

Creates subject: `<file:///Alice.md>` or `<file:///Alice>` (without extension)

### Section Subjects (with header partitioning)
```markdown
# Alice.md
author :: Lewis Carroll

## Character Profile
name :: Alice Wonderland
age :: 25
```

Creates:
- Document: `<file:///Alice>`
- Section: `<file:///Alice#Character_Profile>`

### Identifier Subjects
```markdown
# Story.md

^alice-character

Alice is the protagonist.
name :: Alice
role :: protagonist
```

Creates: `<file:///Story#alice-character>`

### Tag Subjects
```markdown
# Story.md

#character-introduction

Alice appears in this scene.
character :: Alice
scene :: introduction
```

Creates: `<file:///Story#character-introduction>`

## Predicate Generation

### Default Predicates
Without namespaces, properties become URIs under a default namespace:
```markdown
knows :: Bob
```
Becomes: `<http://example.org/knows>`

### Namespace Predicates
With namespace prefixes:
```markdown
schema:knows :: Bob
foaf:knows :: Bob  
dc:creator :: Lewis Carroll
```

Becomes:
```turtle
<http://schema.org/knows>
<http://xmlns.com/foaf/0.1/knows>
<http://purl.org/dc/terms/creator>
```

### Custom Predicates
With custom namespaces:
```javascript
// Configuration
{ namespaces: { 'story': 'http://narrative.org/' } }
```

```markdown
story:characterRole :: protagonist
```

Becomes: `<http://narrative.org/characterRole>`

## Object Generation

### String Literals
```markdown
name :: Alice Wonderland
description :: A curious student
```

Generates:
```turtle
<subject> <predicate> "Alice Wonderland" ;
    <predicate2> "A curious student" .
```

### Typed Literals
Numbers and dates get appropriate types:
```markdown
age :: 25
height :: 5.5
birthDate :: 1998-03-15
isActive :: true
```

Generates:
```turtle
<subject> <http://example.org/age> "25"^^<http://www.w3.org/2001/XMLSchema#integer> ;
    <http://example.org/height> "5.5"^^<http://www.w3.org/2001/XMLSchema#decimal> ;
    <http://example.org/birthDate> "1998-03-15"^^<http://www.w3.org/2001/XMLSchema#date> ;
    <http://example.org/isActive> "true"^^<http://www.w3.org/2001/XMLSchema#boolean> .
```

### Resource References (Links)
```markdown
knows :: [[Bob]]
worksAt :: [[Oxford University]]
homepage :: https://alice.example.com
```

Generates:
```turtle
<subject> <http://example.org/knows> <file:///Bob> ;
    <http://example.org/worksAt> <file:///Oxford_University> ;
    <http://example.org/homepage> <https://alice.example.com> .
```

### Multiple Values
```markdown
knows :: [[Bob]]
knows :: [[Mad Hatter]]
knows :: [[White Rabbit]]
```

Generates:
```turtle
<subject> <http://example.org/knows> <file:///Bob> ;
    <http://example.org/knows> <file:///Mad_Hatter> ;
    <http://example.org/knows> <file:///White_Rabbit> .
```

## Complex RDF Patterns

### Subject-Predicate-Object Triples
```markdown
Alice :: knows :: Bob
Alice :: schema:colleague :: Bob
Professor :: teaches :: Alice
```

Generates:
```turtle
<file:///Alice> <http://example.org/knows> <file:///Bob> .
<file:///Alice> <http://schema.org/colleague> <file:///Bob> .
<file:///Professor> <http://example.org/teaches> <file:///Alice> .
```

### Class Declarations
```markdown
Alice :: rdf:type :: schema:Person
Bob :: rdf:type :: schema:Person
Oxford :: rdf:type :: schema:Organization
```

Generates:
```turtle
<file:///Alice> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://schema.org/Person> .
<file:///Bob> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://schema.org/Person> .
<file:///Oxford> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://schema.org/Organization> .
```

### Frontmatter Integration
```yaml
---
title: Alice's Profile  
author: Lewis Carroll
schema:name: Alice Wonderland
foaf:knows: [Bob, Mad Hatter]
---
```

Generates:
```turtle
<file:///document> <http://schema.org/name> "Alice's Profile" ;
    <http://schema.org/author> "Lewis Carroll" ;
    <http://schema.org/name> "Alice Wonderland" ;
    <http://xmlns.com/foaf/0.1/knows> <file:///Bob> ;
    <http://xmlns.com/foaf/0.1/knows> <file:///Mad_Hatter> .
```

## Text Position Selectors

With `includeSelectors: true`, vault-triplifier adds Web Annotation selectors:

```markdown
# Alice

Alice is 25 years old.
age :: 25
```

Generates RDF including position information:
```turtle
<file:///Alice> <http://example.org/age> "25" ;
    <http://www.w3.org/ns/oa#hasSelector> [
        a <http://www.w3.org/ns/oa#TextPositionSelector> ;
        <http://www.w3.org/ns/oa#start> 42 ;
        <http://www.w3.org/ns/oa#end> 156
    ] .
```

This enables applications to highlight the exact text that contains the semantic information.

## RDF Formats

### Turtle (Default)
```turtle
<file:///Alice> <http://schema.org/name> "Alice Wonderland" ;
    <http://schema.org/age> "25" ;
    <http://xmlns.com/foaf/0.1/knows> <file:///Bob> .
```

### N-Triples
```n-triples
<file:///Alice> <http://schema.org/name> "Alice Wonderland" .
<file:///Alice> <http://schema.org/age> "25" .
<file:///Alice> <http://xmlns.com/foaf/0.1/knows> <file:///Bob> .
```

### JSON-LD
```json
{
  "@context": {
    "schema": "http://schema.org/",
    "foaf": "http://xmlns.com/foaf/0.1/"
  },
  "@id": "file:///Alice",
  "schema:name": "Alice Wonderland",
  "schema:age": "25",
  "foaf:knows": { "@id": "file:///Bob" }
}
```

## Validation and Quality

### SPARQL Queries
Query the generated RDF:
```sparql
# Find all people
SELECT ?person ?name WHERE {
  ?person rdf:type schema:Person ;
          schema:name ?name .
}

# Find Alice's friends
SELECT ?friend WHERE {
  <file:///Alice> foaf:knows ?friend .
}

# Find all relationships
SELECT ?subject ?predicate ?object WHERE {
  ?subject ?predicate ?object .
}
```

### RDF Validation
Use tools like:
- **SHACL**: Shape constraints for validation
- **OWL**: Ontology reasoning and validation  
- **SPARQL**: Query-based validation

Example SHACL constraint:
```turtle
ex:PersonShape a sh:NodeShape ;
    sh:targetClass schema:Person ;
    sh:property [
        sh:path schema:name ;
        sh:minCount 1 ;
        sh:datatype xsd:string
    ] .
```

### Common Validation Issues
```turtle
# Missing required properties
<file:///Alice> rdf:type schema:Person .
# Should have schema:name

# Invalid data types  
<file:///Alice> schema:age "twenty-five" .
# Should be integer: "25"^^xsd:integer

# Broken references
<file:///Alice> foaf:knows <file:///NonExistentPerson> .
# Should reference existing resource
```

## Performance Considerations

### Large Documents
Partitioning affects RDF size and structure:

```markdown
# Without partitioning (1 large entity)
# Alice.md - everything becomes properties of <file:///Alice>

# With partitioning (many smaller entities)  
## Section 1 becomes <file:///Alice#Section_1>
## Section 2 becomes <file:///Alice#Section_2>
^concept becomes <file:///Alice#concept>
```

### Optimization Tips
- **Use appropriate partitioning** for your use case
- **Disable selectors** if position info not needed
- **Use standard namespaces** for better tool compatibility
- **Avoid excessive nesting** in complex properties

## Working with Generated RDF

### Loading into Triple Stores
```javascript
// Using RDF libraries
import { Store } from 'n3'
import { markdownToRDF } from 'vault-triplifier'

const rdfOutput = await markdownToRDF(content, options)
const store = new Store()
store.addQuads(rdfOutput.quads)
```

### Querying with SPARQL
```javascript
// Query the generated data
const results = store.getSubjects(
  'http://xmlns.com/foaf/0.1/knows',
  'file:///Bob',
  null
)
```

### Integration with Semantic Web Tools
- **Apache Jena**: Java-based RDF processing
- **RDFLib**: Python RDF library
- **Oxigraph**: Rust-based triple store
- **GraphDB**: Commercial graph database
- **Blazegraph**: Open-source triple store

## Debugging RDF Output

### Common Issues and Solutions

#### 1. Missing Triples
```markdown
# Problem: Property not appearing in RDF
knows Bob  # Missing ::

# Solution: Use proper syntax
knows :: Bob
```

#### 2. Incorrect URIs
```markdown
# Problem: Spaces in URIs
knows :: [[Bob Smith]]

# Generated (problematic):
<file:///Bob Smith>

# Better approach:
knows :: [[Bob-Smith]]
# Or use proper escaping in tools
```

#### 3. Wrong Data Types
```markdown
# Problem: Numbers as strings
age :: "25"

# Solution: Use unquoted numbers
age :: 25
```

#### 4. Namespace Issues
```markdown
# Problem: Unknown namespace
unknown:property :: value

# Solution: Define namespace or use standard ones
schema:property :: value
```

### Validation Tools
1. **Online RDF Validators**: Validate syntax
2. **SHACL Validators**: Validate data shapes
3. **Reasoning Engines**: Check logical consistency
4. **SPARQL Endpoints**: Query and explore data

### Debugging Workflow
1. **Generate RDF** from your markdown
2. **Validate syntax** with RDF validator
3. **Check structure** with SPARQL queries
4. **Verify semantics** with reasoning tools
5. **Test integration** with target applications

## Advanced RDF Features

### Blank Nodes
Some complex structures generate blank nodes:
```markdown
address :: {
  street :: 123 Main St
  city :: Oxford
}
```

Generates:
```turtle
<file:///Alice> <http://example.org/address> [
    <http://example.org/street> "123 Main St" ;
    <http://example.org/city> "Oxford"
] .
```

### Language Tags
Multi-language support:
```markdown
# Configuration with language detection
name@en :: Alice Wonderland
name@es :: Alicia Maravillas
```

### Custom Data Types
Using XSD types:
```markdown
# Automatically typed
temperature :: -10.5  # xsd:decimal
isActive :: true      # xsd:boolean
birthDate :: 1998-03-15  # xsd:date
```

This guide covers the complete RDF output structure and usage patterns. The generated RDF is standards-compliant and ready for use with any RDF-based system or semantic web application.